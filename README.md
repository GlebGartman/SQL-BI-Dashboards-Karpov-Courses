<h3 align="center">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</h3>
<p align="center">
–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ <strong>Karpov.Courses</strong> –∏ –ø–æ—Å–≤—è—â—ë–Ω –∞–Ω–∞–ª–∏–∑—É –∫–ª—é—á–µ–≤—ã—Ö –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ —Ä–æ–∑–Ω–∏—á–Ω–æ–π —Å–µ—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SQL –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –≤ Redash.  
–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º –∏–∑ –±–∞–∑—ã <strong>PostgreSQL</strong> —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –¥–∏–Ω–∞–º–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤.  
–í —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:  
—á–∏—Å–ª–æ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–∏—Ä–æ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —á–∏—Å–ª–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,  
—á–∏—Å–ª–æ –Ω–æ–≤—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤, –ø—Ä–∏—Ä–æ—Å—Ç –∫—É—Ä—å–µ—Ä–æ–≤, —á–∏—Å–ª–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤ –∏ —Ç.–¥..  
–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å SQL-–∑–∞–ø—Ä–æ—Å—ã —Ä–∞–∑–ª–∏—á–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: LEFT/RIGHT/INNER JOIN, –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∞–≥—Ä–µ–≥–∞—Ç—ã, CTE.
</p>


<details>
<summary><strong>–ó–∞–¥–∞—á–∏</strong></summary>


<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 1: –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤</strong></summary>

üìå –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è:
- `new_users` ‚Äî —á–∏—Å–ª–æ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- `new_couriers` ‚Äî —á–∏—Å–ª–æ –Ω–æ–≤—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤  
- `total_users` ‚Äî –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- `total_couriers` ‚Äî –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∫—É—Ä—å–µ—Ä–æ–≤  
- `date` ‚Äî –¥–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è  

üî¢ –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –≤–∏–¥–µ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –¥–∞—Ç–µ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é

---


<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 2: –ü—Ä–∏—Ä–æ—Å—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö</strong></summary>

üìå –î–æ–ø–æ–ª–Ω–µ–Ω –∑–∞–ø—Ä–æ—Å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–∏:

- `new_users_change` ‚Äî –ø—Ä–∏—Ä–æ—Å—Ç —á–∏—Å–ª–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (%)
- `new_couriers_change` ‚Äî –ø—Ä–∏—Ä–æ—Å—Ç —á–∏—Å–ª–∞ –Ω–æ–≤—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤ (%)
- `total_users_growth` ‚Äî –ø—Ä–∏—Ä–æ—Å—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (%)
- `total_couriers_growth` ‚Äî –ø—Ä–∏—Ä–æ—Å—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∫—É—Ä—å–µ—Ä–æ–≤ (%)

üìê –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–∫—Ä—É–≥–ª–µ–Ω—ã –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –¥–∞—Ç–µ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è.

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 3: –ü–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—å–µ—Ä—ã</strong></summary>

üìå –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –±—ã–ª–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

- `paying_users` ‚Äî —á–∏—Å–ª–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- `active_couriers` ‚Äî —á–∏—Å–ª–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤  
- `paying_users_share` ‚Äî –¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (%)  
- `active_couriers_share` ‚Äî –¥–æ–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤ (%)  
- `date` ‚Äî –¥–∞—Ç–∞

üìê –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏.  
üìä –î–æ–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –∏ –æ–∫—Ä—É–≥–ª–µ–Ω—ã –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –¥–∞—Ç–µ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è.

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 4: –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∏ –µ–¥–∏–Ω–∏—á–Ω—ã–µ –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong></summary>

üìå –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –¥–æ–ª–∏ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

- `single_order_users_share` ‚Äî –¥–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–¥–µ–ª–∞–≤—à–∏—Ö **–æ–¥–∏–Ω –∑–∞–∫–∞–∑**  
- `several_orders_users_share` ‚Äî –¥–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–¥–µ–ª–∞–≤—à–∏—Ö **–±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞**  
- `date` ‚Äî –¥–∞—Ç–∞

üìä –î–æ–ª–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –¥–µ–Ω—å, –≤—ã—Ä–∞–∂–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –∏ –æ–∫—Ä—É–≥–ª–µ–Ω—ã –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –¥–∞—Ç—ã.

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 5: –ü–µ—Ä–≤—ã–µ –∑–∞–∫–∞–∑—ã –∏ –∑–∞–∫–∞–∑—ã –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong></summary>

üìå –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

- `orders` ‚Äî –æ–±—â–µ–µ —á–∏—Å–ª–æ –∑–∞–∫–∞–∑–æ–≤  
- `first_orders` ‚Äî —á–∏—Å–ª–æ **–ø–µ—Ä–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
- `new_users_orders` ‚Äî —á–∏—Å–ª–æ –∑–∞–∫–∞–∑–æ–≤, —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö **–≤ –¥–µ–Ω—å –ø–µ—Ä–≤–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  
- `first_orders_share` ‚Äî –¥–æ–ª—è –ø–µ—Ä–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ (%)  
- `new_users_orders_share` ‚Äî –¥–æ–ª—è –∑–∞–∫–∞–∑–æ–≤ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ (%)  
- `date` ‚Äî –¥–∞—Ç–∞

üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –≤—ã—Ä–∞–∂–µ–Ω—ã —Ü–µ–ª—ã–º–∏ —á–∏—Å–ª–∞–º–∏.  
üìä –î–æ–ª–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, –æ–∫—Ä—É–≥–ª–µ–Ω—ã –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –¥–∞—Ç—ã.

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 6: –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞</strong></summary>

üìå –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞:

- `users_per_courier` ‚Äî —á–∏—Å–ª–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞  
- `orders_per_courier` ‚Äî —á–∏—Å–ª–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞  
- `date` ‚Äî –¥–∞—Ç–∞

üìä –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –æ–∫—Ä—É–≥–ª–µ–Ω—ã –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –¥–∞—Ç–µ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è.

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 7: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏</strong></summary>

üìå –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å:

- `minutes_to_deliver` ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –≤ –º–∏–Ω—É—Ç–∞—Ö  
- `date` ‚Äî –¥–∞—Ç–∞

‚è± –í —Ä–∞—Å—á—ë—Ç–∞—Ö —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ **–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã**, –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ ‚Äî –∏—Å–∫–ª—é—á–µ–Ω—ã.  
üìä –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –æ–∫—Ä—É–≥–ª–µ–Ω–æ –¥–æ —Ü–µ–ª—ã—Ö –º–∏–Ω—É—Ç.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –¥–∞—Ç–µ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è.

---
<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 8: –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —á–∞—Å–∞–º</strong></summary>

üìå –î–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Å–∞ —Å—É—Ç–æ–∫ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

- `successful_orders` ‚Äî —á–∏—Å–ª–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤  
- `canceled_orders` ‚Äî —á–∏—Å–ª–æ –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤  
- `cancel_rate` ‚Äî –¥–æ–ª—è –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –≤ –æ–±—â–µ–º —á–∏—Å–ª–µ –∑–∞–∫–∞–∑–æ–≤  
- `hour` ‚Äî —á–∞—Å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–æ—Ç 0 –¥–æ 23)

üìä –î–æ–ª—è –æ—Ç–º–µ–Ω —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –≤ **–¥–æ–ª–µ –µ–¥–∏–Ω–∏—Ü—ã** –∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∞ –¥–æ **—Ç—Ä—ë—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π**.  
üìÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –∫–æ–ª–æ–Ω–∫–∏ `hour`.


</details>


<details>
<summary><strong>–ö–æ–¥—ã SQL –∏ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</strong></summary>       
<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 1: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ ‚Äî –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤</strong></summary>

### –ö–æ–¥

```sql
SELECT date, new_users, new_couriers, 
       sum(new_users) over(order by date)::INTEGER as total_users, 
       sum(new_couriers) over(order by date)::INTEGER as total_couriers 
FROM 
(
  SELECT time_courier as date, new_users, new_couriers 
  FROM 
    (SELECT time_user, count(time_user) as new_users 
     FROM 
       (SELECT user_id, time::date as time_user, 
               row_number() OVER(PARTITION BY user_id ORDER BY time) as porydok 
        FROM user_actions
       ) as porydok_users
     WHERE porydok = 1
     GROUP BY time_user
    ) as unique_day_users

  JOIN

    (SELECT time_courier, count(time_courier) as new_couriers 
     FROM 
       (SELECT courier_id, time::date as time_courier, 
               row_number() OVER(PARTITION BY courier_id ORDER BY time) as porydok 
        FROM courier_actions
       ) as porydok_couriers
     WHERE porydok = 1
     GROUP BY time_courier
    ) as porydok_couriers

  ON time_courier = time_user
) as kolvo;
```

### –î–∏–Ω–∞–º–∏–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤

![–ì—Ä–∞—Ñ–∏–∫ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤](https://drive.google.com/uc?export=view&id=1utO-05YZpRS3nRqrh6x_8n9m1BiIJjgs)

### –î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

![–ì—Ä–∞—Ñ–∏–∫ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π](https://drive.google.com/uc?export=view&id=1e-nVF563jSuhsUVFSUA3gTwyMko3EB8y)

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 2: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ ‚Äî –ü—Ä–∏—Ä–æ—Å—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö</strong></summary>

### –ö–æ–¥

```sql
SELECT date,
new_users,
new_couriers,
total_users,
total_couriers,
ROUND(100 * (new_users - lag(new_users, 1) over(order by date)) / lag(new_users, 1) over(order by date)::NUMERIC, 2)  as new_users_change,
ROUND(100 * (new_couriers- lag(new_couriers, 1) over(order by date)) / lag(new_couriers, 1) over(order by date)::NUMERIC, 2) as new_couriers_change,
ROUND(100 * (total_users- lag(total_users, 1) over(order by date)) / lag(total_users, 1) over(order by date)::NUMERIC, 2) as total_users_growth, 
ROUND(100 * (total_couriers- lag(total_couriers, 1) over(order by date)) / lag(total_couriers, 1) over(order by date)::NUMERIC, 2) as total_couriers_growth
FROM 
(SELECT date, new_users, new_couriers, sum(new_users) over(order by date)::INTEGER as total_users, sum(new_couriers) over(order by date)::INTEGER  as total_couriers FROM 
  (SELECT time_courier as date, new_users, new_couriers FROM 
   (SELECT time_user, count(time_user) as new_users FROM 
    (SELECT user_id, time::date as time_user, row_number() OVER(PARTITION BY user_id ORDER BY time) as porydok FROM user_actions
     order by user_id) as porydok_users
   WHERE porydok = 1
   group by time_user
   order by time_user) as unique_day_users
 
   JOIN
 
    (SELECT time_courier, count(time_courier) as new_couriers FROM 
      (SELECT courier_id, time::date as time_courier, row_number() OVER(PARTITION BY courier_id ORDER BY time) as porydok FROM courier_actions
       order by courier_id) as porydok_couriers
     WHERE porydok = 1
     group by time_courier
     order by time_courier) as porydok_couriers
 
   on time_courier = time_user) as kolvo) as prirost
```

### –î–∏–Ω–∞–º–∏–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤

![–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–∏—Ä–æ—Å—Ç–∞ —á–∏—Å–ª–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤](https://drive.google.com/uc?export=view&id=1CiWQGpS8T5Z0BNDC18igPf8G5adOpr7q)

### –î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

![–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤](https://drive.google.com/uc?export=view&id=1icXQY02osg4VnqJoHWMnL04OBT_scHhn)

---


<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 3: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ ‚Äî  –ü–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—å–µ—Ä—ã</strong></summary>

### –ö–æ–¥

```sql
  WITH plat as (
   SELECT order_id
   FROM user_actions
   group by order_id
   HAVING count(order_id) = 1
   order by order_id
   ),
   
   dostavka as ( 
   SELECT order_id
   FROM courier_actions
   group by order_id
   HAVING count(order_id) = 2
   order by order_id)
   

SELECT date,
paying_users,
active_couriers,
ROUND(paying_users * 100 / total_users::NUMERIC, 2) as paying_users_share,
ROUND(active_couriers * 100 / total_couriers::NUMERIC, 2) as active_couriers_share
FROM 
 (SELECT date, paying_users, sum(new_users) over(order by date)::INTEGER as total_users, paying_couriers as active_couriers,  sum(new_couriers) over(order by date)::INTEGER  as total_couriers FROM
  (SELECT  time_user as date, new_users, paying_users, new_couriers, paying_couriers FROM 
   (SELECT time_user, count(time_user) FILTER (WHERE porydok = 1) as new_users, count(DISTINCT user_id) FILTER (WHERE order_id in (SELECT * FROM plat)) as paying_users FROM 
      (SELECT order_id, user_id, time::date as time_user, row_number() OVER(PARTITION BY user_id ORDER BY time) as porydok FROM user_actions
       order by user_id) as porydok_users
     group by time_user
     order by time_user) as porydok_users
    
     JOIN
   
     (SELECT time_courier, count(time_courier) FILTER (WHERE porydok = 1) as new_couriers, count(DISTINCT courier_id) FILTER (WHERE order_id in (SELECT * FROM dostavka)) as paying_couriers FROM 
      (SELECT order_id, courier_id, time::date as time_courier, row_number() OVER(PARTITION BY courier_id ORDER BY time) as porydok FROM courier_actions
       order by courier_id) as porydok_couriers
     group by time_courier
     order by time_courier) as porydok_couriers
   
     on time_user = time_courier) as spisok) as pay_total
```

### –î–∏–Ω–∞–º–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫—É—Ä—å–µ—Ä–æ–≤

![–ì—Ä–∞—Ñ–∏–∫: –ø–ª–∞—Ç—è—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—å–µ—Ä—ã](https://drive.google.com/uc?export=view&id=1eIjAjc-Q1jPW0GJRCErM5_9g493P94Om)

### –î–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤

![–ì—Ä–∞—Ñ–∏–∫: –¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤](https://drive.google.com/uc?export=view&id=1BzlEcj1iwV6rgeaHPCrMADZDy1UkptpW)


---


<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 4: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ ‚Äî  –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∏ –µ–¥–∏–Ω–∏—á–Ω—ã–µ –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong></summary>

### –ö–æ–¥

```sql
  SELECT order_id
   FROM user_actions
   group by order_id
   HAVING count(order_id) = 1
   order by order_id
   )
   
SELECT date, ROUND(edinic * 100 / paying_users::NUMERIC, 2) as single_order_users_share, ROUND(mnogo * 100 / paying_users::NUMERIC, 2) as several_orders_users_share FROM 
 (SELECT pay_users.time_user as date, paying_users, edinic, mnogo FROM 
  (SELECT time_user, count(DISTINCT user_id) FILTER (WHERE order_id in (SELECT * FROM plat)) as paying_users FROM 
       (SELECT order_id, user_id, time::date as time_user, row_number() OVER(PARTITION BY user_id ORDER BY time) as porydok FROM user_actions
        order by user_id) as porydok_users
      group by time_user
      order by time_user) as pay_users
   
    JOIN
    
  (SELECT time_user, count(user_id) FILTER(WHERE kolvo = 1) as edinic, count(user_id) FILTER(WHERE kolvo > 1) as mnogo FROM 
       (SELECT time::date as time_user, user_id, count(user_id) as kolvo FROM user_actions
        WHERE order_id in (SELECT * FROM plat)
        group by time_user, user_id) as kolvo_zakazov
    group by time_user
    order by time_user) as zakazy 

on zakazy.time_user = pay_users.time_user) as kolvo_users

```

### –î–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–¥–Ω–∏–º –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–∫–∞–∑–∞–º–∏

![–ì—Ä–∞—Ñ–∏–∫: –¥–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–¥–Ω–∏–º –∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–∫–∞–∑–∞–º–∏](https://drive.google.com/uc?export=view&id=1JNS3PEi35YFaQeru784HHRwtrv6HRpvT)


---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 5: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ - –ü–µ—Ä–≤—ã–µ –∑–∞–∫–∞–∑—ã –∏ –∑–∞–∫–∞–∑—ã –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</strong></summary>

### –ö–æ–¥

```sql
 WITH plat as (
   SELECT order_id
   FROM user_actions
   group by order_id
   HAVING count(order_id) = 1
   order by order_id
   ),
   
   dostavka as ( 
   SELECT order_id
   FROM courier_actions
   group by order_id
   HAVING count(order_id) = 2
   order by order_id)
   

 
 SELECT date,
 orders,
 first_orders,
 new_users_orders,
 ROUND(first_orders * 100 / orders::NUMERIC, 2) as first_orders_share,
 ROUND(new_users_orders * 100 / orders::NUMERIC, 2) as new_users_orders_share
 FROM
  (SELECT time::DATE as date,
   count(order_id) as orders,
   count(order_id) FILTER(WHERE perv = 1) as first_orders,
   count(order_id) FILTER(WHERE perv = new_zakazy)  as new_users_orders
   FROM  
    (SELECT user_id, order_id, action, time, 
     row_number() over(PARTITION BY user_id order by time) as perv,
     row_number() over(PARTITION BY user_id, time::DATE order by time) as new_zakazy
     FROM user_actions
     WHERE order_id in (SELECT * FROM plat) and order_id in (SELECT * FROM dostavka)
     order by user_id) as kolvo
    group by date) as chislo
  order by date


```

### –î–∏–Ω–∞–º–∏–∫–∞ –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤, –ø–µ—Ä–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

![–ì—Ä–∞—Ñ–∏–∫: –æ–±—â–µ–µ —á–∏—Å–ª–æ –∑–∞–∫–∞–∑–æ–≤, –ø–µ—Ä–≤—ã–µ –∑–∞–∫–∞–∑—ã –∏ –∑–∞–∫–∞–∑—ã –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π](https://drive.google.com/uc?export=view&id=1wgOsmV1aESJPmckZXNmBGJSj4wJSLXli)

### –î–æ–ª—è –ø–µ—Ä–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –æ–±—â–µ–º —á–∏—Å–ª–µ –∑–∞–∫–∞–∑–æ–≤

![–ì—Ä–∞—Ñ–∏–∫: –¥–æ–ª—è –ø–µ—Ä–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π](https://drive.google.com/uc?export=view&id=156PJkrx9Tb4US5EjVopOTwiuGlorO2vI)


---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 6: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ - –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞</strong></summary>

### –ö–æ–¥

```sql
 WITH plat as (
   SELECT order_id
   FROM user_actions
   group by order_id
   HAVING count(order_id) = 1
   order by order_id
   ),
   
   dostavka as ( 
   SELECT order_id
   FROM courier_actions
   group by order_id
   HAVING count(order_id) = 2
   order by order_id)
   
   
   SELECT time_courier as date, ROUND(paying_users / active_couriers::NUMERIC, 2) as users_per_courier, orders_per_courier FROM
     (SELECT time_user, count(DISTINCT user_id) FILTER (WHERE order_id in (SELECT * FROM plat)) as paying_users FROM 
       (SELECT order_id, user_id, time::date as time_user, row_number() OVER(PARTITION BY user_id ORDER BY time) as porydok FROM user_actions
        order by user_id) as porydok_users
      group by time_user
      order by time_user) as users
      
      JOIN
     
    (SELECT time_courier, active_couriers, active_orders, ROUND(active_orders / active_couriers::NUMERIC, 2) as orders_per_courier FROM  
     (SELECT time_courier,
      count(DISTINCT courier_id) FILTER(WHERE order_id in (SELECT * FROM dostavka)) as active_couriers, 
      count(DISTINCT order_id) FILTER(WHERE action = 'accept_order' and order_id in (SELECT * FROM plat)) as active_orders FROM
      (SELECT order_id, courier_id, time::date as time_courier, action, row_number() OVER(PARTITION BY courier_id ORDER BY time) as porydok FROM courier_actions 
         order by courier_id) as porydok_couriers
      group by time_courier
      order by time_courier) as zakazy) as couriers
      
      on time_courier = time_user
      
```

### –î–∏–Ω–∞–º–∏–∫–∞ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞

![–ì—Ä–∞—Ñ–∏–∫: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∑–∞–∫–∞–∑—ã –Ω–∞ –æ–¥–Ω–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞](https://drive.google.com/uc?export=view&id=1Pom84jhHidr3iB1dfb6aTADgSg6ymWQ8)

---


<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 7: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏</strong></summary>

```sql
WITH plat as (
   SELECT order_id
   FROM user_actions
   group by order_id
   HAVING count(order_id) = 1
   order by order_id
   ),
   
   dostavka as ( 
   SELECT order_id
   FROM courier_actions
   group by order_id
   HAVING count(order_id) = 2
   order by order_id)
   
   
  SELECT deliver_time::DATE as date, (avg(diff) / 60)::INTEGER as minutes_to_deliver FROM 
   (SELECT order_id, accept_time, deliver_time, EXTRACT(EPOCH from AGE(deliver_time, accept_time)) as diff FROM 
     (SELECT order_id, min(time) as accept_time, max(time) as deliver_time FROM 
      (SELECT * FROM courier_actions
      WHERE order_id in (SELECT * FROM dostavka) and order_id in (SELECT * FROM plat)) as kyrery
    group by order_id 
    order by order_id) as vremya) as vremya_zakaz 
   group by date
   order by date

```

### –î–∏–Ω–∞–º–∏–∫–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ –∑–∞–∫–∞–∑–æ–≤

![–ì—Ä–∞—Ñ–∏–∫: —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏](https://drive.google.com/uc?export=view&id=1TlQhF3_v7Y1XD-A1Y5vugl0u2GPsJBrE)

---

<summary><strong>–ó–∞–¥–∞–Ω–∏–µ 8: –ö–æ–¥ –∏ –≥—Ä–∞—Ñ–∏–∫ - –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ —á–∞—Å–∞–º</strong></summary>

```sql
   WITH otmen as
   (
   SELECT order_id
   FROM user_actions
   group by order_id
   HAVING count(order_id) = 2
   order by order_id
   ),
   
   dostavka as ( 
   SELECT order_id
   FROM courier_actions
   group by order_id
   HAVING count(order_id) = 2
   order by order_id)
   

  SELECT
  hour,  
  successful_orders,
  canceled_orders,
  ROUND(canceled_orders / chislo::NUMERIC, 3) as cancel_rate
  FROM
   (SELECT hour,
   count(order_id) FILTER(WHERE action = 'accept_order') as chislo,
   count(order_id) FILTER(WHERE action = 'accept_order' and order_id in (SELECT * FROM dostavka)) as successful_orders,
   count(order_id) FILTER(WHERE action = 'accept_order' and order_id in (SELECT * FROM otmen)) as canceled_orders 
   FROM
    (SELECT order_id, action, time, DATE_PART('hour', time)::INTEGER as hour FROM courier_actions) as zakazy
    group by hour) as kolvo
   order by hour 
```

### –î–∏–Ω–∞–º–∏–∫–∞ cancel rate –∏ —á–∏—Å–ª–∞ —É—Å–ø–µ—à–Ω—ã—Ö/–æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –ø–æ —á–∞—Å–∞–º

![–ì—Ä–∞—Ñ–∏–∫: cancel rate –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤](https://drive.google.com/uc?export=view&id=1z2zTZzIKf-tpcVcs0r8zddHh7C16wWJF)



</details>

<details> 

<summary><strong>–í—ã–≤–æ–¥—ã</strong></summary>

üìå –ù–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –±—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω –∏—Ç–æ–≥–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥.

üîó [–û—Ç–∫—Ä—ã—Ç—å –¥–∞—à–±–æ—Ä–¥ –≤ Redash](https://redash.public.karpov.courses/public/dashboards/rUhrM7LM2eXf6rI0F6y5aENIzXNnEGr8zJImLWk8?org_slug=default)

</details>
